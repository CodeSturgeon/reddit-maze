Found a small time slot waiting for a job interview. Wrote in optimistic move locking based around move number.